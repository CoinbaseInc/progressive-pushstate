/*! progressive-pushstate 2016-03-30 */
var pp=new function(){function a(a,b){var c;return function(){var d=this,e=arguments,f=function(){a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}}function b(){return void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function c(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}function d(a){if(window.history.replaceState){var d=window.history.href,e=(b(),c(),l.lastState);window.history.replaceState(e,"",d)}}function e(a){var b;b=null!==l.options.defaultState&&null===a.state?l.options.defaultState:a.state,void 0!==l.formEl&&f(b),l.popstateEvent(a,b),l.lastState=b}function f(a){var b,c=l.formEl.elements,d=c.length;for(b=0;d>b;b++){var e=c[b],f=e.name,g=a[f];void 0!==g&&(e.value=g)}}function g(a){var b=a.currentTarget,c=b.href,d=c.split("?");if(2===d.length){var e=d[1];a.preventDefault(),l.updatePushState(a,e)}}function h(a){var b=a.currentTarget||a.target.form,c=l.formData2QueryString(b);if(l.updatePushState(a,c),"submit"===a.type){var d=l.formEl.querySelector("input[autofocus], textarea[autofocus], select[autofocus]");d&&d.focus()}}function j(){var a=window.location;return a.protocol+"//"+a.host+a.pathname}function k(a){var b,c=a.split("#"),d=c[0].split("&"),e=d.length,f={};for(b=0;e>b;b++){var g=d[b],h=g.split("=");f[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return c.length>1&&(f._ppHash=c[1]),f}var l=this,m=screen.orientation||screen.mozOrientation||screen.msOrientation,n=/\s+/g;l.linkEls=[],l.formEls=[],l.lastState={},l.popstateEvent=function(a,b){},l.options={},l.init=function(b,c){l.options=c||{},l.linkEls=document.getElementsByClassName("pp-link");var i=document.getElementsByClassName("pp-form");l.defaultEl=document.getElementsByClassName("pp-default"),l.popstateEvent=b;var j,o=l.linkEls.length,p=i.length;for(j=0;o>j;j++)l.linkEls[j].addEventListener("click",g);if(p>0){l.formEl=i[0];var q=l.formEl.getAttribute("data-pp-events");if(l.formChangeEventDebounced=a(h,l.options.keyDebounceTime||500),q){q=q.split(n);var r=q.length;for(j=0;r>j;j++){var s=q[j];0===s.indexOf("key")?l.formEl.addEventListener(q[j],l.formChangeEventDebounced):l.formEl.addEventListener(q[j],h)}}else l.formEl.addEventListener("submit",h);p>1&&window.console.warn("Only first form.pp-form element will affect the pushstate.")}if(l.defaultEl.length>0&&(l.options.defaultState=k(l.defaultEl[0].href.split("?")[1])),window.addEventListener("popstate",e),l.options.pushScrollState&&(l.scrollEventDebounced=a(d,l.options.debounceTime||50),window.addEventListener("scroll",l.scrollEventDebounced),window.addEventListener("resize",l.scrollEventDebounced),m?m.addEventListener("change",l.scrollEvent):window.addEventListener("orientationchange",l.scrollEvent)),l.options.doPopstateOnload&&window.history.replaceState){var t=location.href.split("?");if(2===t.length){var u=k(t[1]);window.history.replaceState(u,"",window.history.location),void 0!==l.formEl&&f(u),l.popstateEvent({type:"init",target:document,currentTarget:document,state:u}),l.lastState=u}}},l.updatePushState=function(a,b){a.currentTarget;switch(a.type){case"submit":case"click":a.preventDefault()}var c=k(b);if(void 0===l.lastState._ppPageNum&&void 0===a.state?c._ppPageNum=0:"popstate"!==a.type&&(c._ppPageNum=l.lastState._ppPageNum+1),window.history.pushState){var d=j()+"?"+b;window.history.pushState(c,"",d),a.state=c,void 0!==l.formEl&&a.currentTarget!==l.formEl&&f(c),l.popstateEvent(a,c),l.lastState=c}},l.sortObject=function(a){return Object.keys(a).sort().reduce(function(b,c){return b[c]=a[c],b},{})},l.formData2QueryString=function(a,b){var c,d=b||{},e="",f="";for(i=0;i<a.elements.length;i++)switch(c=a.elements[i],c.type){case"select-multiple":for(var g=!1,h=0;h<c.options.length;h++){var j=c.options[h];j.selected&&(d.collapseMulti?g?e+=","+encodeURIComponent(j.value):(e+=c.name+"="+encodeURIComponent(j.value),g=!0):e+=c.name+"="+encodeURIComponent(j.value)+"&")}d.collapseMulti&&(e+="&");break;case"radio":c.checked&&(e+=c.name+"="+encodeURIComponent(c.value)+"&");break;case"checkbox":c.checked&&(d.collapseMulti&&c.name==f?(e.lastIndexOf("&")==e.length-1&&(e=e.substr(0,e.length-1)),e+=","+encodeURIComponent(c.value)):e+=c.name+"="+encodeURIComponent(c.value),e+="&",f=c.name);break;default:e+=c.name+"="+encodeURIComponent(c.value)+"&"}return e=e.substr(0,e.length-1)}};